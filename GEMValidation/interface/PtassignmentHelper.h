#ifndef GEMCode_GEMValidation_Ptassignment_h
#define GEMCode_GEMValidation_Ptassignment_h

#include "DataFormats/GeometryVector/interface/GlobalPoint.h"

namespace PtassignmentHelper {

//eta partitions:1.2-1.4,1.4-1.6,1.6-1.8, 1.8-2.0, 2.0-2.2, 2.2-2.4
enum {EtaPartitions=6, Parity=4, NPt=7};
//slopes_1 = [1.279, 0.6357, 1.001, 0.5252]
//slopes_2 = [0.640, .353, .555, .310]

const double PositionEpLUT[Parity][EtaPartitions][3] = {
    		//prop_factor, slope, intercept
		{{1.279, 0.04784, 0.1122},
		 {1.279, 0.65424, 0.09761},
    		 {0.640, 0.05527, 0.08944},
		 {0.640, 0.08295, 0.1279},
		 {0.640, 0.1660, 0.2158},
		 {0.640, 0.4952, 0.7103},
		},
		{{0.6357, 0.0827, 0.2021},
		 {0.6357, 0.0906, 0.1773},
		 {0.3530, 0.1067, 0.1957},
		 {0.3530, 0.1561, 0.2645},
		 {0.3530, 0.3156, 0.4514},
		 {0.3530, 0.8242, 1.0712},
		},
		{{1.001, 0.038, 0.008345},
		 {1.001, 0.04157, 0.0617},
		 {0.5550, 0.0562, 0.08417},
		 {0.5550, 0.0870, 0.1426},
		 {0.5550, 0.1676, 0.2198},
		 {0.5550, 0.4953, 0.7272},
		},
		{{0.5252, 0.0739, 0.1714},
		 {0.5252, 0.07838, 0.1307},
		 {0.310, 0.1066, 0.2026},
		 {0.310, 0.1435, 0.2118},
		 {0.310, 0.2874, 0.4055},
		 {0.310, 0.7625, 1.075},
		},
	};

/*const double PositionEpLUT[Parity][EtaPartitions][3] = {
    		//prop_factor, slope, intercept
		{{1.279, 0.04784, 0.1122},
		 {1.279, 0.65424, 0.09761},
    		 {0.648, 0.05527, 0.08944},
		 {0.648, 0.08295, 0.1279},
		 {0.648, 0.1660, 0.2158},
		 {0.648, 0.4952, 0.7103},
		},
		{{0.6357, 0.0827, 0.2021},
		 {0.6357, 0.0906, 0.1773},
		 {0.3542, 0.1067, 0.1957},
		 {0.3542, 0.1561, 0.2645},
		 {0.3542, 0.3156, 0.4514},
		 {0.3542, 0.8242, 1.0712},
		},
		{{1.001, 0.038, 0.008345},
		 {1.001, 0.04157, 0.0617},
		 {0.5636, 0.0562, 0.08417},
		 {0.5636, 0.0870, 0.1426},
		 {0.5636, 0.1676, 0.2198},
		 {0.5636, 0.4953, 0.7272},
		},
		{{0.5252, 0.0739, 0.1714},
		 {0.5252, 0.07838, 0.1307},
		 {0.3217, 0.1066, 0.2026},
		 {0.3217, 0.1435, 0.2118},
		 {0.3217, 0.2874, 0.4055},
		 {0.3217, 0.7625, 1.075},
		},
	};



const double DirectionEpLUT[Parity][EtaPartitions][2]={
    	       {{2.907, 5.906},
		{2.600, 5.191},
		{4.530, 9.422},
		{5.788, 9.743},
		{8.367, 10.22},
		{11.02, 14.84},
	       },
	       {{2.409, 5.198},
		{2.467, 4.397},
		{4.779, 9.954},
		{6.273, 11.91},
		{9.315, 12.21},
		{10.34, 11.02},
	       },
	       {{2.301, 4.929},
		{2.230, 3.111},
		{7.677, 16.82},
		{7.726, 13.36},
		{9.621, 10.62},
		{11.23, 13.44},
	       },
	       {{2.401, 4.758},
		{2.383, 3.782},
		{7.720, 16.91},
		{8.643, 16.45},
		{10.02, 11.83},
		{11.83, 17.66},
	       },
	};
*/

const int PtBins[NPt] = {5,7,10,15,20,30,40};

const double DirectionbasedDeltaPhiLUT[NPt][EtaPartitions][Parity] = {
	{
	  {0.259700,0.262583,0.268300,0.219000},
	  {0.237450,0.233740,0.226125,0.228200},
	  {0.169275,0.142050,0.168600,0.154100},
	  {0.121850,0.112550,0.111200,0.114133},
	  {0.109200,0.095475,0.106850,0.090400},
	  {0,0,0,0},
	},//pt=5
	{
	  {0.162100,0.162950,0.162300,0.128350},
	  {0.162850,0.150087,0.160250,0.157750},
	  {0.106850,0.085625,0.115875,0.085800},
	  {0.085825,0.073150,0.079950,0.070550},
	  {0.094100,0.071175,0.086317,0.076400},
	  {0,0,0,0},
	},//pt=7
	{
	  {0.118550,0.123264,0.119860,0.123350},
	  {0.126400,0.119917,0.120000,0.128150},
	  {0.090383,0.058650,0.082750,0.056225},
	  {0.067100,0.050583,0.065400,0.052219},
	  {0.073575,0.070983,0.080912,0.073425},
	  {0,0,0,0},
	},//pt=10
	{
	  {0.081200,0.098813,0.091312,0.109500},
	  {0.090150,0.094400,0.101638,0.104400},
	  {0.063525,0.040633,0.077600,0.046200},
	  {0.055113,0.038667,0.059300,0.042813},
	  {0.072817,0.062100,0.080633,0.063250},
	  {0,0,0,0},
	},//pt=15
	{
	  {0.089625,0.093300,0.087305,0.127450},
	  {0.078250,0.091792,0.093188,0.072600},
	  {0.061750,0.034830,0.068600,0.039667},
	  {0.051025,0.034975,0.058067,0.040700},
	  {0.071850,0.055300,0.081950,0.059100},
	  {0,0,0,0},
	},//pt=20
	{
	  {0.077600,0.092469,0.087571,0.060950},
	  {0.111200,0.095543,0.091250,0.078750},
	  {0.060775,0.029388,0.061700,0.036575},
	  {0.051408,0.029807,0.053220,0.040820},
	  {0.066533,0.049900,0.073700,0.057950},
	  {0,0,0,0},
	},//pt=30
	{
	  {0.065200,0.090742,0.088683,0.035300},
	  {0.092400,0.091480,0.090338,0.093300},
	  {0.064700,0.026436,0.060800,0.039600},
	  {0.050500,0.029375,0.057660,0.039475},
	  {0.068983,0.047413,0.074288,0.055500},
	  {0,0,0,0},
	},//pt=40

};


const double PositionbasedDDYLUT[NPt][EtaPartitions][Parity] = {
	{
	  {12.464000,7.834000,16.116000,8.560000},
	  {9.038000,5.218286,10.590000,5.328000},
	  {8.881000,4.782000,8.984000,5.204000},
	  {6.247000,3.567333,6.116000,3.548000},
	  {3.288000,1.866000,3.397000,1.878667},
	  {0,0,0,0},
	},//pt=5
	{
	  {7.084000,3.957500,8.190000,4.256000},
	  {5.574000,3.079000,6.290000,3.430000},
	  {4.814000,3.070000,5.270000,3.090667},
	  {3.631500,2.177333,3.670571,2.116000},
	  {2.082000,1.216000,2.039500,1.215200},
	  {0,0,0,0},
	},//pt=7
	{
	  {4.682000,2.461000,4.933333,3.098000},
	  {4.116000,1.960769,3.946667,2.186000},
	  {3.406000,1.913000,3.336667,1.916000},
	  {2.375200,1.476250,2.387000,1.407778},
	  {1.418833,0.849800,1.411778,0.898375},
	  {0,0,0,0},
	},//pt=10
	{
	  {2.876000,1.508095,3.002500,1.444000},
	  {2.616000,1.288632,2.555125,1.596000},
	  {2.087333,1.272000,2.011000,1.282667},
	  {1.576857,0.975714,1.630400,1.013000},
	  {1.002250,0.682667,1.002769,0.649231},
	  {0,0,0,0},
	},//pt=15
	{
	  {2.265000,1.168000,2.208600,1.242000},
	  {1.990000,0.982500,1.889818,1.124000},
	  {1.670000,1.016500,1.654000,1.086667},
	  {1.264200,0.836769,1.248500,0.799714},
	  {0.844800,0.597750,0.851200,0.572750},
	  {0,0,0,0},
	},//pt=20
	{
	  {1.624000,0.896636,1.507692,0.958000},
	  {1.454000,0.781857,1.330000,0.870000},
	  {1.287333,0.785500,1.304667,0.772286},
	  {0.926000,0.690500,0.911478,0.658222},
	  {0.686462,0.480667,0.667556,0.472111},
	  {0,0,0,0},
	},//pt=30
	{
	  {1.108000,0.736800,1.277700,0.612000},
	  {1.078000,0.646783,1.086267,0.452000},
	  {1.362667,0.675778,1.046000,0.712000},
	  {0.788421,0.588889,0.779500,0.567250},
	  {0.629667,0.478250,0.577429,0.465714},
	  {0,0,0,0},
	},//pt=40

};


const double DirectionbasedDeltaPhiME21onlyLUT[NPt][EtaPartitions][Parity] = {
	{
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	},//pt=5
	{
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	},//pt=7
	{
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	},//pt=10
	{
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	},//pt=15
	{
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	},//pt=20
	{
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	  {1,1,1,1},
	},//pt=30
};


//pt,npar,eta->a,b,anlge,x0,y0
//pt:5,7,10,15,20,30:
const double HybridDDYAndDeltaPhiLUT[NPt][EtaPartitions][Parity][5] = {
        
	{//npt=0, pt=5
	    {
		{12.900000,0.217517,0.000000,0.000000,-0.000000},
		{4.500000,0.283008,0.000000,0.000000,-0.000000},
		{9.000000,0.320000,0.000000,0.309710,-0.004582},
		{5.100000,0.219589,0.000000,0.641146,-0.019085},
	    },
	    {
		{8.700000,0.292285,0.000000,0.000000,-0.000000},
		{3.000000,0.288281,0.000000,0.493732,-0.016262},
		{6.900000,0.600000,0.000000,0.000000,-0.000000},
		{3.900000,0.650000,0.000000,0.000000,-0.000000},
	    },
	    {
		{5.100000,0.487500,0.000000,0.191335,-0.002266},
		{3.000000,0.200000,0.000000,0.000000,-0.000000},
		{5.400000,0.600000,0.000000,0.000000,-0.000000},
		{3.300000,0.200000,0.000000,0.053964,-0.000583},
	    },
	    {
		{3.600000,0.700000,0.000000,0.000000,-0.000000},
		{2.100000,0.300000,0.000000,0.152403,-0.001823},
		{3.900000,0.550000,0.000000,0.000000,-0.000000},
		{2.400000,0.200000,0.000000,0.037030,-0.000277},
	    },
	    {
		{2.100000,0.675000,0.000000,0.000000,-0.000000},
		{1.500000,0.137500,0.000000,0.000000,-0.000000},
		{2.100000,0.600000,0.000000,0.000000,0.000000},
		{1.500000,0.500000,0.000000,0.123604,-0.000303},
	    },
	},
	{//pt=7
	    {
		{6.300000,0.287500,0.000000,0.000000,-0.000000},
		{3.000000,0.400000,0.000000,0.000000,-0.000000},
		{6.300000,0.307617,0.000000,0.000000,-0.000000},
		{3.900000,0.210782,0.000000,0.000000,-0.000000},
	    },
	    {
		{6.300000,0.198810,0.000000,0.000000,-0.000000},
		{2.700000,0.275000,0.000000,0.000000,-0.000000},
		{5.700000,0.269617,0.000000,0.000000,-0.000000},
		{2.700000,0.550000,0.000000,0.000000,-0.000000},
	    },
	    {
		{3.600000,0.275000,0.000000,0.000000,-0.000000},
		{2.700000,0.095703,0.000000,0.000000,-0.000000},
		{3.600000,0.400000,0.000000,0.000000,-0.000000},
		{2.400000,0.200000,0.000000,0.000000,-0.000000},
	    },
	    {
		{3.000000,0.268750,0.000000,0.000000,-0.000000},
		{1.800000,0.112500,0.000000,0.032307,-0.000353},
		{3.000000,0.131250,0.000000,0.053255,-0.000235},
		{2.100000,0.137500,0.000000,0.000000,-0.000000},
	    },
	    {
		{1.800000,0.237500,0.000000,0.000000,-0.000000},
		{1.200000,0.187500,0.000000,0.029240,0.000079},
		{1.800000,0.231250,0.000000,0.245271,0.001308},
		{1.200000,0.500000,0.000000,0.000000,-0.000000},
	    },
	},
	{//pt=10
	    {
		{4.500000,0.300000,0.000000,0.000000,-0.000000},
		{2.100000,0.400000,0.000000,0.000000,-0.000000},
		{4.200000,0.400000,0.000000,0.000000,-0.000000},
		{2.400000,0.400000,0.000000,0.000000,-0.000000},
	    },
	    {
		{3.300000,0.250000,0.000000,0.157426,-0.001423},
		{1.800000,0.275000,0.000000,0.163588,-0.005329},
		{3.900000,0.220313,0.000000,0.000000,-0.000000},
		{2.100000,0.300000,0.000000,0.000000,-0.000000},
	    },
	    {
		{2.700000,0.400000,0.000000,0.000000,-0.000000},
		{2.100000,0.071875,0.000000,0.000000,-0.000000},
		{3.300000,0.300000,0.000000,0.000000,-0.000000},
		{1.800000,0.162500,0.000000,0.000000,-0.000000},
	    },
	    {
		{2.100000,0.200000,0.000000,0.172146,-0.000606},
		{1.200000,0.081250,0.000000,0.199668,-0.002185},
		{2.100000,0.175000,0.000000,0.171970,-0.000764},
		{1.500000,0.212500,0.000000,0.000000,-0.000000},
	    },
	    {
		{1.500000,0.525000,0.000000,0.000000,-0.000000},
		{1.200000,0.118750,0.000000,0.023047,0.000216},
		{1.800000,0.225000,0.000000,0.078742,0.000838},
		{1.200000,0.156250,0.000000,0.009407,0.000050},
	    },
	},
	{//pt=15
	    {
		{3.300000,0.250000,0.000000,0.000000,-0.000000},
		{1.500000,0.400000,0.000000,0.000000,-0.000000},
		{3.000000,0.193750,0.000000,0.000000,-0.000000},
		{2.400000,0.135352,0.000000,0.000000,-0.000000},
	    },
	    {
		{3.000000,0.175000,0.000000,0.000000,-0.000000},
		{1.200000,0.225000,0.000000,0.244104,-0.007649},
		{2.400000,0.275000,0.000000,0.252971,-0.004051},
		{2.100000,0.169336,0.000000,0.026777,-0.000950},
	    },
	    {
		{2.100000,0.212500,0.000000,0.175867,-0.001930},
		{1.200000,0.056250,0.000000,0.187035,-0.003667},
		{2.400000,0.125000,0.000000,0.044684,-0.000406},
		{1.800000,0.200000,0.000000,0.000000,-0.000000},
	    },
	    {
		{1.800000,0.700000,0.000000,0.000000,-0.000000},
		{0.900000,0.112500,0.000000,0.152053,-0.001693},
		{1.500000,0.100000,0.000000,0.255042,-0.001810},
		{1.500000,0.125000,0.000000,0.000000,0.000000},
	    },
	    {
		{1.500000,0.156250,0.000000,0.015012,-0.000073},
		{1.200000,0.137500,0.000000,0.033389,0.000464},
		{1.500000,0.237500,0.000000,0.120700,0.002284},
		{0.900000,0.331250,0.000000,0.000000,0.000000},
	    },
	},
	{//pt=20
	    {
		{2.400000,0.400000,0.000000,0.151353,-0.008018},
		{1.200000,0.450000,0.000000,0.000000,-0.000000},
		{2.400000,0.175000,0.000000,0.000000,-0.000000},
		{1.500000,0.112500,0.000000,0.037791,-0.001752},
	    },
	    {
		{3.300000,0.135360,0.000000,0.223976,-0.001455},
		{0.900000,0.218750,0.000000,0.197348,-0.005743},
		{1.800000,0.200000,0.000000,0.197683,-0.002836},
		{1.500000,0.550000,0.000000,0.176672,-0.004753},
	    },
	    {
		{1.500000,0.150000,0.000000,0.157531,-0.001353},
		{2.100000,0.068750,0.000000,0.000000,-0.000000},
		{2.100000,0.175000,0.000000,0.072348,-0.001039},
		{1.200000,0.175000,0.000000,0.183459,-0.000422},
	    },
	    {
		{1.800000,0.137500,0.000000,0.000000,0.000000},
		{0.900000,0.068750,0.000000,0.154629,-0.001118},
		{1.200000,0.131250,0.000000,0.207718,-0.001213},
		{1.200000,0.081250,0.000000,0.022022,-0.000040},
	    },
	    {
		{1.200000,0.156250,0.000000,0.011603,-0.000057},
		{1.200000,0.112500,0.000000,0.007020,0.000272},
		{1.200000,0.212500,0.000000,0.122639,0.002245},
		{0.900000,0.331250,0.000000,0.000000,-0.000000},
	    },
	},
	{//pt=30
	    {
		{2.100000,0.400000,0.000000,0.170191,-0.011848},
		{0.900000,0.256250,0.000000,0.169226,-0.006358},
		{1.500000,0.225000,0.000000,0.151479,-0.001942},
		{4.800000,0.650000,0.000000,0.000000,-0.000000},
	    },
	    {
		{3.000000,0.106250,0.000000,0.000000,-0.000000},
		{0.900000,0.225000,0.000000,0.159882,-0.000736},
		{1.500000,0.187500,0.000000,0.034574,-0.000521},
		{0.900000,0.175000,0.000000,0.000000,-0.000000},
	    },
	    {
		{1.200000,0.081250,0.000000,0.280995,-0.004438},
		{2.400000,0.027344,0.000000,0.000000,-0.000000},
		{2.100000,0.068750,0.000000,0.000000,-0.000000},
		{3.300000,0.065405,0.000000,0.000000,-0.000000},
	    },
	    {
		{1.200000,0.087500,0.000000,0.147253,-0.001066},
		{0.900000,0.100000,0.000000,0.000000,-0.000000},
		{1.200000,0.600000,0.000000,0.152421,-0.006013},
		{0.900000,0.300000,0.000000,0.056065,0.000482},
	    },
	    {
		{1.200000,0.200000,0.000000,0.077350,-0.001441},
		{1.800000,0.793750,0.000000,0.017912,0.005428},
		{1.800000,0.203040,0.000000,0.125940,0.009159},
		{0.600000,0.487500,0.000000,0.000000,-0.000000},
	    },
	},
	{//pt=40
	    {
		{1.800000,0.056250,0.000000,0.728845,-0.035947},
		{0.900000,0.137500,0.000000,0.117756,-0.008075},
		{1.200000,0.231250,0.000000,0.259540,-0.006759},
		{0.600000,0.125000,0.000000,0.123788,0.001463},
	    },
	    {
		{0.900000,0.400000,0.000000,-0.000000,-0.000000},
		{2.100000,0.372070,0.000000,0.169291,0.005314},
		{0.900000,0.200000,0.000000,0.252559,-0.001208},
		{0.600000,0.150000,0.000000,0.104395,0.019780},
	    },
	    {
		{0.900000,0.037500,0.000000,0.068694,-0.014613},
		{6.300000,0.076861,0.000000,-0.006100,-0.000288},
		{3.000000,0.187500,0.000000,0.384107,0.004417},
		{0.600000,0.025000,0.000000,0.026198,-0.000665},
	    },
	    {
		{0.600000,0.043750,0.000000,0.107871,0.001475},
		{0.600000,0.062500,0.000000,0.056518,-0.000443},
		{6.000000,0.787500,0.000000,-0.054483,-0.025185},
		{3.000000,0.075000,0.000000,-0.021668,0.004513},
	    },
	    {
		{1.200000,0.168750,0.000000,0.145961,0.005202},
		{0.600000,0.018750,0.000000,0.000000,0.000000},
		{1.200000,0.137500,0.000000,0.082988,0.004342},
		{0.600000,0.437500,0.000000,0.000000,-0.000000},
	    },
	},
};
/*
const double HybridDDYAndDeltaPhiLUT[NPt][Parity][EtaPartitions][5] = {
        
	{//npt=0, pt=5
	 {//npar=0
	  {12.900000,0.217517,0.000000,0.000000,-0.000000},//eta 1.2-14.
	  {8.700000,0.292285,0.000000,0.000000,-0.000000},//eta 1.4-1.6
	  {5.400000,0.500000,0.000000,0.000000,-0.000000},//eta 1.6-1.8
	  {3.600000,0.700000,0.000000,0.000000,-0.000000},//eta 1.8-2.0
	  {2.100000,0.675000,0.000000,0.000000,-0.000000},//eta 2.0-2.2
	  {1,1,0,0,0},//eta 2.2-2.4
	  },
	 {//npar=1
	  {4.500000,0.283008,0.000000,0.000000,-0.000000},
	  {3.300000,0.500000,0.000000,0.000000,-0.000000},
	  {3.000000,0.200000,0.000000,0.000000,-0.000000},
	  {2.400000,0.137500,0.000000,0.000000,-0.000000},
	  {1.500000,0.137500,0.000000,0.000000,-0.000000},
	  {1,1,0,0,0},
	 },
	 {//npar=2
	  {8.700000,0.625000,0.000000,0.000000,-0.000000},
	  {6.900000,0.600000,0.000000,0.000000,-0.000000},
	  {5.400000,0.600000,0.000000,0.000000,-0.000000},
	  {3.900000,0.550000,0.000000,0.000000,-0.000000},
	  {2.100000,0.600000,0.000000,0.000000,0.000000},
	  {1,1,0,0,0},
	 },
	 {//npar=3
	  {6.000000,0.240805,0.000000,0.000000,-0.000000},
	  {3.900000,0.650000,0.000000,0.000000,-0.000000},
	  {3.300000,0.225000,0.000000,0.000000,-0.000000},
	  {2.400000,0.225000,0.000000,0.000000,-0.000000},
	  {1.500000,0.450000,0.000000,0.000000,-0.000000},
	  {1,1,0,0,0},
	 },
        },

	{//npt=1, pt=7
	 {//npar=0
	  {6.300000,0.287500,0.000000,0.000000,-0.000000},//eta 1.2-14.
	  {6.300000,0.198810,0.000000,0.000000,-0.000000},//eta 1.4-1.6
	  {3.600000,0.275000,0.000000,0.000000,-0.000000},//eta 1.6-1.8
	  {3.000000,0.268750,0.000000,0.000000,-0.000000},//eta 1.8-2.0
	  {1.800000,0.237500,0.000000,0.000000,-0.000000},//eta 2.0-2.2
	  {1,1,0,0,0},//eta 2.2-2.4
	  },
	 {//npar=1
	  {3.000000,0.400000,0.000000,0.000000,-0.000000},
	  {2.700000,0.275000,0.000000,0.000000,-0.000000},
	  {2.700000,0.095703,0.000000,0.000000,-0.000000},
	  {1.800000,0.118750,0.000000,0.000000,-0.000000},
	  {1.200000,0.200000,0.000000,0.000000,0.000000},
	  {1,1,0,0,0},
	 },
	 {//npar=2
	  {6.300000,0.307617,0.000000,0.000000,-0.000000},
	  {5.700000,0.269617,0.000000,0.000000,-0.000000},
	  {3.600000,0.400000,0.000000,0.000000,-0.000000},
	  {3.000000,0.143750,0.000000,0.000000,-0.000000},
	  {2.100000,0.225000,0.000000,0.000000,0.000000},
	  {1,1,0,0,0},
	 },
	 {//npar=3
	  {3.900000,0.210782,0.000000,0.000000,-0.000000},
	  {2.700000,0.550000,0.000000,0.000000,-0.000000},
	  {2.400000,0.200000,0.000000,0.000000,-0.000000},
	  {2.100000,0.137500,0.000000,0.000000,-0.000000},
	  {1.200000,0.500000,0.000000,0.000000,-0.000000},
	  {1,1,0,0,0},
	 },
        },

	{//npt=2, pt=10
	 {//npar=0
	  {4.800000,0.167578,0.000000,0.078078,-0.001824},//eta 1.2-14.
	  {3.900000,0.224219,0.000000,0.000000,-0.000000},//eta 1.4-1.6
	  {3.000000,0.400000,0.000000,0.000000,-0.000000},//eta 1.6-1.8
	  {2.100000,0.150000,0.000000,0.168925,-0.000937},//eta 1.8-2.0
	  {1.800000,0.600000,0.000000,0.000000,-0.000000},//eta 2.0-2.2
	  {1,1,0,0,0},//eta 2.2-2.4
	  },
	 {//npar=1
	  {2.400000,0.300000,0.000000,0.000000,-0.000000},
	  {2.100000,0.200000,0.000000,0.000000,-0.000000},
	  {1.800000,0.075000,0.000000,0.000000,-0.000000},
	  {1.500000,0.075000,0.000000,0.024682,-0.000272},
	  {1.200000,0.056250,0.000000,0.026576,-0.000284},
	  {1,1,0,0,0},
	 },
	 {//npar=2
	  {4.200000,0.400000,0.000000,0.000000,-0.000000},
	  {3.900000,0.211133,0.000000,0.083966,-0.001333},
	  {2.400000,0.256250,0.000000,0.232345,-0.002233},
	  {2.100000,0.156250,0.000000,0.167997,-0.000450},
	  {1.800000,0.425000,0.000000,0.000000,-0.000000},
	  {1,1,0,0,0},
	 },
	 {//npar=3
	  {3.300000,0.400000,0.000000,0.000000,-0.000000},
	  {1.800000,0.400000,0.000000,0.000000,-0.000000},
	  {1.800000,0.162500,0.000000,0.033521,-0.000329},
	  {1.500000,0.112500,0.000000,0.091360,-0.000374},
	  {1.200000,0.156250,0.000000,0.011796,-0.000057},
	  {1,1,0,0,0},
	 },
        },

	{//npt=3, pt=15
	 {//npar=0
	  {3.300000,0.250000,0.000000,0.000000,-0.000000},//eta 1.2-14.
	  {3.000000,0.175000,0.000000,0.000000,-0.000000},//eta 1.4-1.6
	  {2.400000,0.150000,0.000000,0.000000,-0.000000},//eta 1.6-1.8
	  {2.400000,0.150000,0.000000,0.000000,-0.000000},//eta 1.8-2.0
	  {1.500000,0.156250,0.000000,0.000000,-0.000000},//eta 2.0-2.2
	  {1,1,0,0,0},//eta 2.2-2.4
	  },
	 {//npar=1
	  {1.500000,0.400000,0.000000,0.000000,-0.000000},
	  {1.500000,0.225000,0.000000,0.000000,-0.000000},
	  {1.500000,0.075000,0.000000,0.000000,-0.000000},
	  {1.200000,0.056250,0.000000,0.000000,-0.000000},
	  {1.200000,0.137500,0.000000,0.000000,0.000000},
	  {1,1,0,0,0},
	 },
	 {//npar=2
	  {3.000000,0.193750,0.000000,0.000000,-0.000000},
	  {2.700000,0.300000,0.000000,0.000000,-0.000000},
	  {2.400000,0.137500,0.000000,0.000000,-0.000000},
	  {1.800000,0.100000,0.000000,0.000000,-0.000000},
	  {1.500000,0.268750,0.000000,0.000000,0.000000},
	  {1,1,0,0,0},
	 },
	 {//npar=3
	  {2.400000,0.135352,0.000000,0.000000,-0.000000},
	  {1.800000,0.350000,0.000000,0.000000,-0.000000},
	  {1.800000,0.200000,0.000000,0.000000,-0.000000},
	  {1.500000,0.125000,0.000000,0.000000,0.000000},
	  {0.900000,0.331250,0.000000,0.000000,0.000000},
	  {1,1,0,0,0},
	 },
        },

	{//npt=4, pt=20
	 {//npar=0
	  {2.700000,0.400000,0.000000,0.000000,-0.000000},//eta 1.2-14.
	  {3.600000,0.135360,0.000000,0.000000,-0.000000},//eta 1.4-1.6
	  {1.800000,0.100000,0.000000,0.000000,-0.000000},//eta 1.6-1.8
	  {1.800000,0.137500,0.000000,0.000000,0.000000},//eta 1.8-2.0
	  {1.200000,0.162500,0.000000,0.000000,-0.000000},//eta 2.0-2.2
	  {1,1,0,0,0},//eta 2.2-2.4
	  },
	 {//npar=1
	  {1.200000,0.450000,0.000000,0.000000,-0.000000},
	  {1.200000,0.181250,0.000000,0.000000,-0.000000},
	  {2.100000,0.068750,0.000000,0.000000,-0.000000},
	  {1.200000,0.050000,0.000000,0.000000,-0.000000},
	  {1.200000,0.118750,0.000000,0.000000,0.000000},
	  {1,1,0,0,0},
	 },
	 {//npar=2
	  {2.400000,0.175000,0.000000,0.000000,-0.000000},
	  {2.100000,0.200000,0.000000,0.000000,-0.000000},
	  {2.100000,0.206250,0.000000,0.000000,-0.000000},
	  {1.500000,0.112500,0.000000,0.000000,-0.000000},
	  {1.200000,0.225000,0.000000,0.000000,0.000000},
	  {1,1,0,0,0},
	 },
	 {//npar=3
	  {1.500000,0.137500,0.000000,0.000000,-0.000000},
	  {1.800000,0.350000,0.000000,0.000000,-0.000000},
	  {1.500000,0.168750,0.000000,0.000000,-0.000000},
	  {1.200000,0.081250,0.000000,0.000000,-0.000000},
	  {0.900000,0.331250,0.000000,0.000000,-0.000000},
	  {1,1,0,0,0},
	 },
        },

	{//npt=5, pt=30
	 {//npar=0
	  {2.400000,0.237500,0.000000,0.000000,-0.000000},//eta 1.2-14.
	  {3.000000,0.106250,0.000000,0.000000,-0.000000},//eta 1.4-1.6
	  {1.500000,0.081250,0.000000,0.000000,-0.000000},//eta 1.6-1.8
	  {1.200000,0.118750,0.000000,0.000000,-0.000000},//eta 1.8-2.0
	  {1.200000,0.243750,0.000000,0.000000,-0.000000},//eta 2.0-2.2
	  {1,1,0,0,0},//eta 2.2-2.4
	  },
	 {//npar=1
	  {1.200000,0.187500,0.000000,0.000000,-0.000000},
	  {1.200000,0.187500,0.000000,0.000000,-0.000000},
	  {2.400000,0.027344,0.000000,0.000000,-0.000000},
	  {0.900000,0.100000,0.000000,0.000000,-0.000000},
	  {30.000000,0.800000,0.000000,0.000000,0.000000},
	  {1,1,0,0,0},
	 },
	 {//npar=2
	  {1.800000,0.168750,0.000000,0.000000,-0.000000},
	  {1.500000,0.200000,0.000000,0.000000,-0.000000},
	  {2.100000,0.068750,0.000000,0.000000,-0.000000},
	  {1.500000,0.200000,0.000000,0.000000,-0.000000},
	  {1.800000,0.289178,0.000000,0.000000,0.000000},
	  {1,1,0,0,0},
	 },
	 {//npar=3
	  {4.800000,0.650000,0.000000,0.000000,-0.000000},
	  {0.900000,0.175000,0.000000,0.000000,-0.000000},
	  {3.300000,0.065405,0.000000,0.000000,-0.000000},
	  {0.900000,0.400000,0.000000,0.000000,0.000000},
	  {0.600000,0.487500,0.000000,0.000000,-0.000000},
	  {1,1,0,0,0},
	 },
        },

};*/
//updated the LUT, by Tao, 20160724
const double DirectionEpLUT[Parity][EtaPartitions][2]={
    	       {{2.907, 5.906},
		{2.600, 5.191},
		{4.405, 8.809},
		{7.332, 14.478},
		{8.747, 12.265},
		//{11.02, 14.84},
	       },
	       {{2.409, 5.198},
		{2.467, 4.397},
		{4.411, 8.621},
		{7.333, 14.552},
		{8.955, 13.093},
		//{10.34, 11.02},
	       },
	       {{2.301, 4.929},
		{2.230, 3.111},
		{5.288, 10.987},
		{8.242, 16.698},
		{9.213, 13.111},
		//{11.23, 13.44},
	       },
	       {{2.401, 4.758},
		{2.383, 3.782},
		{5.222, 10.769},
		{8.292, 16.955},
		{9.074, 12.083},
		//{11.83, 17.66},
	       },
	};

// phi_momentum = phi_position+gem-csc_bending*slope
const double BendingAngleLUT[2][2] = {
	{28.71,12.86},//even,odd for ME11
	{39.11,18.31},

};

int GetEtaPartition(float eta);

float ellipse(float a, float b,float anlge, float x0, float y0, float x, float y);

float Ptassign_Position(float deltay12, float deltay23, float eta, int par);

float Ptassign_Position_gp(GlobalPoint gp1, GlobalPoint gp2, GlobalPoint gp3, float eta, int par);

float deltaYcalculation(GlobalPoint gp1, GlobalPoint gp2);

float Ptassign_Direction(float bending_12, float eta, int par);

float PhiMomentum(float dphi, float phi_position, int st, bool evenodd);
float PhiMomentum_Radius(float dphi, float phi_position, float radius_csc, float radius_gem);
float PhiMomentum_Xfactor(float dphi, float phi_position, float x);
float PhiMomentum_Xfactor_V2(float phi_CSC, float phi_GEM, float x);


void calculateAlphaBeta(const std::vector<float>& v, 
                        const std::vector<float>& w, 
                        const std::vector<float>& ev, 
                        const std::vector<float>& ew, 
                        const std::vector<float>& status,
                        float& alpha, float& beta);

float normalizePhi(float phi);

}

#endif
